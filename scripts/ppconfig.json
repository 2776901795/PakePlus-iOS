{"name":"xintailiuhecai","url":"http://dh.47hecai.top/","showName":"47极速导航","appid":"com.xintailiuhecai.app","icon":"","iconRound":true,"state":true,"single":true,"injectJq":true,"tauriApi":false,"devbug":false,"version":"1.0.2","preview":"Android","platform":["1-1","1-2","2-1","2-2","3-1","3-2"],"width":412,"height":915,"desc":"","jsFile":[],"filterCss":".app-info, div.app-info, p.app-intro, div.app-download-link, form[action=\"download.php\"], button[type=\"submit\"].nav-btn.app-download-btn","customJs":"\nconst hookClick = (e) => {\n    const origin = e.target.closest('a')\n    const isBaseTargetBlank = document.querySelector(\n        'head base[target=\"_blank\"]'\n    )\n    console.log('origin', origin, isBaseTargetBlank)\n    if (\n        (origin && origin.href && origin.target === '_blank') ||\n        (origin && origin.href && isBaseTargetBlank)\n    ) {\n        e.preventDefault()\n        console.log('handle origin', origin)\n        location.href = origin.href\n    } else {\n        console.log('not handle origin', origin)\n    }\n}\n\ndocument.addEventListener('click', hookClick, { capture: true })\n\n// ===========================================\n// 以下为新增版本显示和检查功能，不影响原有脚本功能\n// ===========================================\n\n// 当前版本信息配置\nconst currentVersion = {\n  version: \"1.0.2\", // 当前APP版本号\n  buildDate: new Date().toISOString().split('T')[0]\n};\n\n// 在页面加载完成后执行的函数\nfunction initCustomFeatures() {\n  // 1. 显示版本信息\n  showVersionInfo();\n  \n  // 2. 检查新版本\n  checkForUpdates();\n  \n  // 3. 隐藏APP下载相关元素\n  hideAppDownloadElements();\n}\n\n// 显示版本信息函数\nfunction showVersionInfo() {\n  // 创建版本信息元素\n  const versionElement = document.createElement('div');\n  versionElement.className = 'version-info';\n  versionElement.id = 'app-version-info';\n  versionElement.style.cssText = 'font-size:0.7rem;color:#999;text-align:center;margin-top:5px;padding-bottom:5px;';\n  \n  // 设置版本信息内容\n  versionElement.textContent = `v${currentVersion.version}`;\n  \n  // 查找页脚元素并添加版本信息\n  const footer = document.querySelector('.footer');\n  if (footer) {\n    footer.appendChild(versionElement);\n  }\n  \n  // 在控制台输出详细版本信息\n  console.log(\n    '%c极速导航 ' + \n    '%cv' + currentVersion.version + \n    '%c构建于 ' + currentVersion.buildDate,\n    'color:#1a73e8;font-weight:bold;', \n    'color:#4caf50;font-weight:bold;', \n    'color:#666;'\n  );\n}\n\n// 比较版本号\nfunction compareVersions(v1, v2) {\n  const parts1 = v1.split('.').map(Number);\n  const parts2 = v2.split('.').map(Number);\n  \n  for (let i = 0; i < Math.max(parts1.length, parts2.length); i++) {\n    const part1 = parts1[i] || 0;\n    const part2 = parts2[i] || 0;\n    \n    if (part1 < part2) return -1; // v1 < v2\n    if (part1 > part2) return 1;  // v1 > v2\n  }\n  \n  return 0; // v1 == v2\n}\n\n// 从download.php中获取最新版本号\nfunction checkForUpdates() {\n  // 创建一个隐藏的iframe来加载download.php\n  const iframe = document.createElement('iframe');\n  iframe.style.display = 'none';\n  iframe.src = 'download.php';\n  \n  iframe.onload = function() {\n    try {\n      // 尝试从iframe中提取版本信息\n      const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;\n      const versionElement = iframeDoc.querySelector('.app-version');\n      \n      if (versionElement) {\n        // 提取版本号 (例如从 \"版本: 0.0.2\" 中提取 \"0.0.2\")\n        const latestVersionText = versionElement.textContent;\n        const latestVersion = latestVersionText.replace(/[^0-9.]/g, '');\n        \n        console.log('检测到最新版本:', latestVersion);\n        console.log('当前版本:', currentVersion.version);\n        \n        // 如果有新版本可用\n        if (compareVersions(currentVersion.version, latestVersion) < 0) {\n          showUpdateNotification(latestVersion);\n        }\n      }\n      \n      // 移除iframe\n      setTimeout(() => {\n        document.body.removeChild(iframe);\n      }, 100);\n      \n    } catch (e) {\n      console.error('获取版本信息失败:', e);\n      // 移除iframe\n      document.body.removeChild(iframe);\n    }\n  };\n  \n  // 添加iframe到body\n  document.body.appendChild(iframe);\n}\n\n// 显示更新提示\nfunction showUpdateNotification(newVersion) {\n  // 创建更新提示元素\n  const updateNotice = document.createElement('div');\n  updateNotice.className = 'update-notification';\n  updateNotice.style.cssText = `\n    position: fixed;\n    bottom: 20px;\n    left: 50%;\n    transform: translateX(-50%);\n    background-color: #1a73e8;\n    color: white;\n    padding: 10px 20px;\n    border-radius: 50px;\n    box-shadow: 0 3px 10px rgba(0,0,0,0.2);\n    font-size: 14px;\n    display: flex;\n    align-items: center;\n    z-index: 1000;\n    cursor: pointer;\n  `;\n  \n  // 设置更新提示内容\n  updateNotice.innerHTML = `\n    <span style=\"margin-right:10px;\">发现新版本 v${newVersion}</span>\n    <button style=\"background:#fff;color:#1a73e8;border:none;border-radius:20px;padding:5px 15px;font-weight:bold;font-size:12px;\">立即更新</button>\n  `;\n  \n  // 添加点击事件，跳转到下载页\n  updateNotice.addEventListener('click', function() {\n    window.location.href = 'download.php';\n  });\n  \n  // 添加到页面\n  document.body.appendChild(updateNotice);\n  \n  // 更新版本显示元素\n  const versionElement = document.getElementById('app-version-info');\n  if (versionElement) {\n    versionElement.textContent = `v${currentVersion.version} (有新版本)`;\n    versionElement.style.color = '#ff6b00';\n  }\n}\n\n// 隐藏APP下载相关元素函数\nfunction hideAppDownloadElements() {\n  // 首先尝试直接通过CSS隐藏元素\n  const style = document.createElement('style');\n  style.textContent = `\n    .app-info, \n    p.app-intro, \n    .app-download-link, \n    button.nav-btn.app-download-btn, \n    form[action=\"download.php\"] {\n      display: none !important;\n    }\n  `;\n  document.head.appendChild(style);\n  \n  // 然后通过JavaScript再次确认元素被隐藏\n  setTimeout(() => {\n    const selectors = [\n      '.app-info', \n      'p.app-intro', \n      '.app-download-link', \n      'button.nav-btn.app-download-btn', \n      'form[action=\"download.php\"]'\n    ];\n    \n    selectors.forEach(selector => {\n      const elements = document.querySelectorAll(selector);\n      elements.forEach(el => {\n        el.style.display = 'none';\n      });\n    });\n  }, 100);\n}\n\n// 在页面加载完成时执行自定义功能\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', initCustomFeatures);\n} else {\n  // 如果页面已经加载完成，直接执行\n  initCustomFeatures();\n}","isHtml":false,"htmlPath":"","htmlFiles":[],"more":{"windows":{"label":"","title":"47极速导航","url":"http://dh.47hecai.top/","userAgent":"Mozilla/5.0 (Linux; Android 14; Pixel 6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Mobile Safari/537.36","width":412,"height":915,"theme":null,"resizable":true,"fullscreen":false,"maximized":false,"minWidth":400,"minHeight":300,"maxWidth":1920,"maxHeight":1080,"decorations":true,"transparent":false,"titleBarStyle":"Visible","visible":true,"focus":true,"closable":true,"minimizable":true,"maximizable":true,"alwaysOnTop":false,"alwaysOnBottom":false,"center":false,"skipTaskbar":false,"tabbingIdentifier":null,"parent":null,"dragDropEnabled":true,"browserExtensionsEnabled":false,"devtools":true,"contentProtected":false,"hiddenTitle":false,"incognito":false,"proxyUrl":null,"useHttpsScheme":false,"zoomHotkeysEnabled":false,"acceptFirstMouse":false,"create":false}},"phone":{"safeArea":{"top":0,"bottom":0,"left":0,"right":0},"header":{"show":false,"title":"","backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","loading":false,"toolBar":false,"toolBarBackgroundColor":"","toolBarColor":"","toolBarFontSize":16,"toolBarFontWeight":"bold"},"siderMenu":{"show":false,"width":0,"backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","title":"","titleColor":"","titleFontSize":16,"titleFontWeight":"bold"},"tabBar":{"show":false,"backgroundColor":"","color":"","activeColor":"","fontSize":16,"fontWeight":"bold","tabBarItem":[]}},"ios":{"name":"xintailiuhecai","showName":"47极速导航","version":"1.0.2","webUrl":"http://dh.47hecai.top/","id":"com.xintailiuhecai.app.ios","icon":"./app-icon.png","desc":"PakePlus Project by 1024xiaoshen","pubBody":"PakePlus android build body","isHtml":false,"debug":false},"android":{"name":"xintailiuhecai","showName":"47极速导航","version":"1.0.2","webUrl":"http://dh.47hecai.top/","id":"com.xintailiuhecai.app.android","icon":"./app-icon.png","input":"./app-icon.png","output":"./res","rounded":true,"copyTo":"./app/src/main/res","androidResDir":"./app/src/main/res","desc":"PakePlus Project by 1024xiaoshen","pubBody":"PakePlus android build body","isHtml":false,"debug":false},"desktop":{"name":"xintailiuhecai","showName":"47极速导航","version":"1.0.2","id":"com.xintailiuhecai.app.desktop","desc":"74 Ultra-fast Navigation","webUrl":"http://dh.47hecai.top/","iconPath":"../app-icon.png","inputPath":"../app-icon.png","tempPath":"./processed-image.png","icnsPath":"../src-tauri/icons/icon.icns","pubBody":"74 Ultra-fast Navigation","isHtml":false,"single":true,"state":true,"injectJq":false,"tauriApi":false,"debug":false}}